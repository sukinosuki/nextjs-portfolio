import { projects } from '@/data/projects'
import { motion, useScroll, useTransform } from 'framer-motion'
import { useRef } from 'react'

const ProjectSection: React.FC = () => {
  const targetRef = useRef(null)
  const listWrapperRef = useRef(null)

  const { scrollYProgress } = useScroll({
    target: targetRef,
    offset: ['start start', 'end start'],
  })
  const { scrollYProgress: scrollYProgress2 } = useScroll({
    target: listWrapperRef,
  })

  const opacity = useTransform(scrollYProgress, [0, 0.3], [1, 0])
  const scale = useTransform(scrollYProgress, [0, 0.6], [1, 0.4])
  const x = useTransform(scrollYProgress2, [0, 1], ['0%', '-30%'])
  const imageHeight = useTransform(scrollYProgress2, [0, 1], [300, 350])

  return (
    <div className='h-190vh' id='projects'>
      <svg height='0' width='0'>
        <defs>
          <clipPath id='svgPath'>
            <path
              fillRule='evenodd'
              clipRule='evenodd'
              d='M426.755 -247.339C526.01 -242.623 630.416 -205.737 691.019 -128.942C747.053 -57.9359 709.403 42.8884 725.408 131.114C738.276 202.044 786.302 264.961 775.404 336.204C763.332 415.132 724.842 490.453 662.532 542.186C597.271 596.368 510.835 641.895 426.755 625.671C345.261 609.947 319.875 506.823 250.249 462.635C174.069 414.287 41.2528 440.785 6.43092 358.913C-27.6816 278.71 83.9568 208.257 106.308 124.209C131.067 31.1084 79.6084 -81.3667 143.094 -154.976C208.865 -231.236 324.689 -252.189 426.755 -247.339Z'
              fill='#FDC435'
            />
          </clipPath>
        </defs>
      </svg>
      <svg height='0' width='0'>
        <defs>
          <clipPath id='flowerPath'>
            <path d='M367.78,150.68c3,.81,5.48,1.44,7.9,2.11,7.83,2.19,15.19,5.25,21.15,11.26,3.87,3.89,4.13,6,1.16,10.54a70.59,70.59,0,0,1-31.92,27.26c-11.5,4.93-22.78,10.44-34.4,15-18,7.1-36.76,8.86-55.9,7.55A118.88,118.88,0,0,1,236.59,215c-3.15-1.35-6.5-2.21-9.61-3.62a80.1,80.1,0,0,1-7.52-4.27,19.59,19.59,0,0,0-1.63-1.17c-3.82-1.75-4.48-2.77-3.11-6.5a27.31,27.31,0,0,1,3.87-7.42c13.76-17.57,27-35.59,41.65-52.38,17.68-20.32,40.21-32.48,66.3-37.2a165.22,165.22,0,0,1,37.21-2.64,26.71,26.71,0,0,1,8.46,1.79c4.34,1.7,5.94,5.62,5,10.31-1.06,5.17-1.82,10.41-3,15.56-1,4.46-2.38,8.83-3.61,13.24C369.73,143.87,368.82,147,367.78,150.68Z' />
            <path d='M98.66,357.5c-5.55,1.94-10.51,3.77-15.53,5.42-5.3,1.74-10.77,1.69-16.23,1.07-4.35-.5-6.08-2.34-6.22-6.84-.4-12.55.86-24.88,7-36,8-14.56,15.64-29.56,25.12-43.1C110.42,252.92,134,235.58,163,226.76c5.07-1.54,10.1-3.26,15.23-4.55,2.75-.69,5.66-.66,8.5-.92.49,0,1,.16,1.49.07,4.93-.93,6.24-.25,6.92,4.74a75,75,0,0,1,.74,13.21q-1.08,24.91-2.63,49.8a149.71,149.71,0,0,1-6.88,36.34,118.62,118.62,0,0,1-30.08,48.66c-7.13,7.07-15,13.4-22.76,19.72a36.06,36.06,0,0,1-9.84,5.5c-4.89,1.87-8.64-.25-10.77-5.14s-4.6-9.84-6.66-14.87c-1.65-4.06-2.92-8.28-4.36-12.43C100.83,363.79,99.76,360.68,98.66,357.5Z' />
            <path d='M32.52,154.13c-4-5.79-7.83-10.59-10.76-15.93A56.39,56.39,0,0,1,17,124.89c-1.26-5.06.16-7.08,4.86-8.84,12.12-4.55,24.54-6.32,37.23-3.47,14.66,3.3,29.55,6,43.78,10.75,28.92,9.69,52.44,27.55,69.71,53.78q4,6.13,8,12.3c1.91,2.92,4.13,5.68,4.31,9.45a2.24,2.24,0,0,0,.51,1.44c1.28,1.07,2.45,2.32,1.51,4a9.57,9.57,0,0,1-3.38,3.76,50.08,50.08,0,0,1-9.88,4.27c-18.59,5.21-37.1,10.83-55.89,15.14-31.71,7.26-61.73,1.92-89.58-15.54-6.7-4.2-13.22-8.76-19.61-13.47a31.21,31.21,0,0,1-6.83-7.07c-3-4.27-2.07-8.72,1.76-12.24,3.57-3.27,6.92-6.8,10.52-10s7.12-6,10.73-9C27.31,158.11,29.91,156.16,32.52,154.13Z' />
            <path d='M199.08,26.28c2-3.26,3.56-5.78,5.15-8.26,4.31-6.7,9.32-12.61,16.35-16.44,4.54-2.48,6.63-2.17,9.69,1.85a73.84,73.84,0,0,1,15.34,39.78c.9,11.81,2.51,23.58,3,35.41,1.49,35.28-8,67-29.42,94.75-2.56,3.32-4.87,6.85-7.56,10a83.73,83.73,0,0,1-6.64,6.41,13.2,13.2,0,0,0-1.47,1.31c-2.49,3.12-3.65,3.53-6.52,1.18a27.48,27.48,0,0,1-6-6.45c-12.12-19.45-25.5-38.09-36-58.59a123.51,123.51,0,0,1-13.93-61.78c.68-18,4.74-35.32,10.64-52.2a28.09,28.09,0,0,1,1.76-3.82C156.69,3.4,162.42,1,168.3,6.18a2.07,2.07,0,0,0,.42.31c5.26,2.92,10.68,5.56,15.72,8.83C189.32,18.49,193.82,22.3,199.08,26.28Z' />
            <path d='M305.65,355.25c.16,3.65.31,6.62.41,9.59.29,8-.24,15.87-3.83,23.25-2.32,4.77-4.39,5.82-9.4,4.33a67.91,67.91,0,0,1-33.42-21.53c-9.18-10.93-19.07-21.33-27.3-33-18.93-26.84-28.05-57.06-26.19-90.54.22-4.05.09-8.14.46-12.18a78.83,78.83,0,0,1,1.64-8.7c.1-.51.43-1,.52-1.46.27-1.45,0-3.76.8-4.19a9.2,9.2,0,0,1,5.77-1.15,71.85,71.85,0,0,1,12.82,3.47c13.9,5.35,27.76,10.82,41.51,16.55A196.19,196.19,0,0,1,288.39,249a115.62,115.62,0,0,1,42.67,40.28c9.24,14.63,15.59,30.59,20.13,47.35a25.52,25.52,0,0,1,.79,7.84c-.23,4.8-3.24,7.57-7.9,8.09-4.9.54-9.77,1.4-14.68,1.84-4.57.41-9.17.47-13.76.64C312.47,355.11,309.29,355.16,305.65,355.25Z' />
          </clipPath>
          {/* <clipPath id='flowerPath'>
            <path d='M117.63,46.5l2.52.65a14.84,14.84,0,0,1,6.77,3.48c1.23,1.2,1.32,1.84.37,3.25a22.4,22.4,0,0,1-10.21,8.41c-3.68,1.53-7.29,3.23-11,4.64A41.78,41.78,0,0,1,88.2,69.26a39.14,39.14,0,0,1-12.53-2.91c-1-.42-2.08-.68-3.08-1.11-.83-.37-1.61-.87-2.4-1.32a4.4,4.4,0,0,0-.52-.36c-1.22-.54-1.44-.86-1-2a8.31,8.31,0,0,1,1.24-2.29c4.4-5.42,8.65-11,13.32-16.16a36.18,36.18,0,0,1,21.21-11.49,55.13,55.13,0,0,1,11.9-.81,8.89,8.89,0,0,1,2.7.55,2.56,2.56,0,0,1,1.6,3.18c-.34,1.6-.59,3.22-1,4.81-.32,1.37-.76,2.72-1.15,4.08C118.25,44.4,118,45.38,117.63,46.5Z' />
            <path d='M31.55,110.33c-1.77.6-3.36,1.16-5,1.67a12.3,12.3,0,0,1-5.19.33c-1.4-.15-1.95-.72-2-2.11-.13-3.87.27-7.68,2.23-11.09a144.24,144.24,0,0,1,8-13.31A41.56,41.56,0,0,1,52.13,70c1.63-.47,3.24-1,4.88-1.4a17.41,17.41,0,0,1,2.71-.29,3.93,3.93,0,0,0,.48,0c1.58-.28,2-.07,2.21,1.47a22.25,22.25,0,0,1,.24,4.08q-.34,7.68-.84,15.36a45.25,45.25,0,0,1-2.2,11.22,36.59,36.59,0,0,1-9.62,15c-2.28,2.18-4.79,4.13-7.28,6.08a11.7,11.7,0,0,1-3.15,1.7,2.54,2.54,0,0,1-3.44-1.59c-.7-1.53-1.47-3-2.13-4.59-.53-1.25-.94-2.55-1.4-3.83C32.25,112.27,31.91,111.31,31.55,110.33Z' />
            <path d='M10.4,47.57C9.13,45.78,7.9,44.3,7,42.65a16.9,16.9,0,0,1-1.52-4.11C5,37,5.49,36.36,7,35.81A21.18,21.18,0,0,1,18.9,34.75a143.85,143.85,0,0,1,14,3.31,41.91,41.91,0,0,1,22.3,16.6c.86,1.26,1.71,2.53,2.57,3.8a5.8,5.8,0,0,1,1.38,2.91.58.58,0,0,0,.16.44c.41.34.78.72.48,1.24a3,3,0,0,1-1.08,1.16,16.49,16.49,0,0,1-3.16,1.32c-5.94,1.61-11.87,3.34-17.88,4.67A37.85,37.85,0,0,1,9,65.41c-2.15-1.3-4.23-2.71-6.28-4.16A9.64,9.64,0,0,1,.57,59.06a2.62,2.62,0,0,1,.56-3.77c1.14-1,2.22-2.1,3.37-3.1s2.27-1.85,3.43-2.76C8.74,48.8,9.57,48.19,10.4,47.57Z' />
            <path d='M63.67,8.11c.65-1,1.14-1.78,1.65-2.55A14.44,14.44,0,0,1,70.55.49c1.45-.77,2.12-.67,3.09.57a22.23,22.23,0,0,1,4.91,12.28c.29,3.64.81,7.27,1,10.92a42.45,42.45,0,0,1-9.4,29.25c-.82,1-1.56,2.11-2.42,3.09a25,25,0,0,1-2.13,2c-.15.14-.34.25-.47.4-.79,1-1.16,1.09-2.08.37a8.62,8.62,0,0,1-1.92-2c-3.88-6-8.16-11.76-11.52-18.08a37.13,37.13,0,0,1-4.45-19.07A53,53,0,0,1,48.52,4.1a8.49,8.49,0,0,1,.56-1.18c1-1.87,2.87-2.61,4.75-1A.6.6,0,0,0,54,2c1.68.9,3.42,1.72,5,2.73S62,6.88,63.67,8.11Z' />
            <path d='M97.75,109.63c.06,1.13.1,2.05.14,3a14.32,14.32,0,0,1-1.23,7.18c-.74,1.47-1.4,1.8-3,1.34A21.77,21.77,0,0,1,83,114.46c-2.94-3.37-6.1-6.58-8.73-10.18a42,42,0,0,1-8.38-27.94c.07-1.25,0-2.51.14-3.76a25.56,25.56,0,0,1,.53-2.69c0-.15.14-.29.17-.45.08-.44,0-1.16.25-1.29a3,3,0,0,1,1.85-.35,23.11,23.11,0,0,1,4.1,1.07c4.44,1.65,8.88,3.34,13.27,5.11a63.19,63.19,0,0,1,6.07,2.85,36.54,36.54,0,0,1,13.64,12.43,52,52,0,0,1,6.44,14.61,7.62,7.62,0,0,1,.25,2.42,2.52,2.52,0,0,1-2.52,2.5c-1.57.17-3.13.43-4.7.57s-2.93.14-4.4.2Z' />
          </clipPath> */}
        </defs>
      </svg>

      <div className='absolute h-140vh w-full' ref={targetRef}>
        <motion.div
          className='sticky top-0 mx-auto overflow-hidden py-20 lg:w-1200px max-md-text-center'
          style={{
            opacity,
            scale,
          }}
        >
          <h5 className='text-center text-10 font-bold'>Projects</h5>
          <h3 className='mt-10 text-30 font-bold leading-none max-md-text-7'>
            Projects / 我的项目
          </h3>
        </motion.div>
      </div>

      <div className='h-80'></div>
      <div className='h-170vh' ref={listWrapperRef}>
        <div className='relative sticky top-0 z-9 h-screen flex items-center overflow-hidden pl-140 max-md-pl-20'>
          <motion.ul
            className='flex flex-nowrap gap-x-10'
            style={{
              x,
            }}
          >
            {projects.map((project, index) => (
              <motion.li
                variants={{
                  hovered: {
                    y: -30,
                  },
                }}
                whileHover='hovered'
                key={index}
                className='relative h-140 w-80 shrink-0 overflow-hidden rounded-2xl bg-#ecefec px-6 py-10 max-md-h-100 max-md-w-60'
              >
                <h3 className='text-8 font-400 leading-none'>{project.name}</h3>

                <p className='mt-4 text-5 text-#828282'>
                  {project.description}
                </p>

                <div className='max-md-hidden'>
                  <motion.div
                    className='absolute bottom-0 left-0 aspect-1 h-40 w-full overflow-hidden rounded-tl-4 rounded-tr-4 bg-white'
                    style={{
                      height: imageHeight,
                    }}
                  >
                    <img
                      src='/images/project_miiro_blog.png'
                      //   src='https://github.com/sukinosuki/duel-links-meta-flutter-app/blob/master/screenshot/setting_dark_mode.jpg?raw=true'
                      className='h-full w-full object-cover'
                      alt=''
                    />
                  </motion.div>
                </div>
              </motion.li>
            ))}
          </motion.ul>
        </div>
      </div>
    </div>
  )
}

export default ProjectSection
